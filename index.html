<!DOCTYPE html>
<html lang="he">
<head>
  <meta charset="UTF-8">
  <title>Speed Math</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      margin: 0;
      font-family: Bookman Old Style;
      text-align: center;
      background: #87CEEB;
    }

    #ui {
      position: relative;
      z-index: 10;
      padding-top: 20px;
    }

    #question {
      font-size: 26px;
      margin: 10px;
      font-weight: bold;
    }

    input {
      font-size: 20px;
      padding: 10px;
      width: 120px;
      border-radius: 12px;
      border: 1px solid #888;
      text-align: center;
    }

    button {
      font-size: 18px;
      padding: 12px 24px;
      border-radius: 12px;
      border: none;
      background: #4CAF50;
      color: white;
      margin-top: 10px;
    }

    canvas {
      display: block;
      margin: 0 auto;
      border: 2px solid black;
      background: #9ad9ff;
    }
  </style>
</head>

<body>

  <div id="ui">
    <h1>Speed Math</h1>
    <div id="question"></div>
    <input id="answer" type="number" inputmode="numeric">
    <br><br>
    <button onclick="check()">Submit</button>
    <p id="result"></p>
  </div>

  <canvas id="gameCanvas" width="320" height="240"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas")
    const ctx = canvas.getContext("2d")

    let a = 0
    let b = 0
    let level = 1
    let season = "winter"
    let operator = "+"
    let score = 0

    let trees = 1
    let flowers = 0
    let cloudOffset = 0
    let leaves = 0
    let snow = 0

    function setSeason() {
      if (level === 1) season = "winter"
      if (level === 2) season = "spring"
      if (level === 3) season = "summer"
      if (level === 4) season = "autumn"

      if (season === "winter") operator = "+"
      if (season === "spring") operator = "-"
      if (season === "summer") operator = "×"
      if (season === "autumn") operator = "÷"
    }

    function newQuestion() {
      a = Math.floor(Math.random() * 10) + 1
      b = Math.floor(Math.random() * 10) + 1

      if (operator === "÷") {
        a = b * (Math.floor(Math.random() * 5) + 1)
      }

      document.getElementById("question").innerText =
        a + " " + operator + " " + b + " = ?"
    }

    function check() {
      const user = Number(document.getElementById("answer").value)

      let correct = 0
      if (operator === "+") correct = a + b
      if (operator === "-") correct = a - b
      if (operator === "×") correct = a * b
      if (operator === "÷") correct = a / b

      if (user === correct) {
        score++

        if (season === "winter") trees++
        if (season === "spring") flowers++
        if (season === "summer") cloudOffset += 10
        if (season === "autumn") leaves++
        if (season === "winter") snow++

        document.getElementById("result").innerText = "Correct"
      } else {
        document.getElementById("result").innerText = "Try again"
      }

      if (score % 5 === 0 && level < 4) {
        level++
        setSeason()
      }

      drawScene()
      newQuestion()
      document.getElementById("answer").value = ""
    }

    function drawScene() {
      ctx.clearRect(0, 0, canvas.width, canvas.height)

      if (season === "winter") ctx.fillStyle = "#ccf2ff"
      if (season === "spring") ctx.fillStyle = "#d4fcd4"
      if (season === "summer") ctx.fillStyle = "#ffeeaa"
      if (season === "autumn") ctx.fillStyle = "#ffddcc"

      ctx.fillRect(0, 0, canvas.width, canvas.height)

      // Ground
      ctx.fillStyle = "#228B22"
      ctx.fillRect(0, 180, canvas.width, 60)

      // Sun
      ctx.fillStyle = "yellow"
      ctx.beginPath()
      ctx.arc(280 - cloudOffset, 40, 20, 0, Math.PI*2)
      ctx.fill()

      // Cloud
      ctx.fillStyle = "white"
      ctx.beginPath()
      ctx.arc(260 - cloudOffset, 40, 12, 0, Math.PI*2)
      ctx.arc(275 - cloudOffset, 35, 12, 0, Math.PI*2)
      ctx.arc(290 - cloudOffset, 40, 12, 0, Math.PI*2)
      ctx.fill()

      // Trees
      for (let i = 0; i < trees; i++) {
        let x = 30 + i * 30

        ctx.fillStyle = "#8B4513"
        ctx.fillRect(x, 150, 10, 30)

        ctx.fillStyle = "green"
        ctx.beginPath()
        ctx.arc(x + 5, 145, 15, 0, Math.PI*2)
        ctx.fill()
      }

      // Snow
      if (season === "winter") {
        ctx.fillStyle = "white"
        for (let i = 0; i < snow; i++) {
          let x = (i * 20) % canvas.width
          let y = (i * 15) % canvas.height
          ctx.beginPath()
          ctx.arc(x, y, 2, 0, Math.PI*2)
          ctx.fill()
        }
      }

      // Flowers
      if (season === "spring") {
        for (let i = 0; i < flowers; i++) {
          let x = (i * 25) % canvas.width
          let y = 170

          ctx.fillStyle = "pink"
          ctx.beginPath()
          ctx.arc(x, y, 4, 0, Math.PI*2)
          ctx.fill()
        }
      }

      // Leaves
      if (season === "autumn") {
        for (let i = 0; i < leaves; i++) {
          let x = (i * 20) % canvas.width
          let y = 100 + (i * 10)

          ctx.fillStyle = "orange"
          ctx.beginPath()
          ctx.arc(x, y, 4, 0, Math.PI*2)
          ctx.fill()
        }
      }
    }

    setSeason()
    newQuestion()
    drawScene()
  </script>

</body>
</html>
